{template '_header'}
<style>
    .fui-page-group {
        overflow-y: scroll;
    }

    .coupon-carve {
        background: #ff3c00;
        padding-bottom: 1.3rem;
    }

    .coupon-carve .header {
        height: 20.95rem;
        background: url('../addons/ewei_shopv2/static/images/coupon-share.png') repeat-y;
        -webkit-background-size: 100% 100%;
        background-size: 100% 100%;
    }

    /*公用title*/
    .carve-title {
        text-align: center;
        font-size: .75rem;
        color: #fff;
        font-weight: bold;
        height: 2.75rem;
        line-height: 2.75rem;
    }

    .carve-title img {
        display: inline-block;
        width: .875rem;
        height: .775rem;
        vertical-align: middle;
    }

    .carve-title span {
        margin: 0 .7rem;
        position: relative;
        top: .05rem;
    }

    /*卡片式 */
    .content-card {
        width: 17.15rem;
        height: auto;
        padding: .5rem;
        margin: 0 auto;
        border-radius: .5rem;
        min-height: 3rem;
        box-shadow: 0 .4rem .4rem rgba(228, 69, 65, .5);
        background: linear-gradient(to bottom, #ff6f47, #ff4746) !important;
    }

    .content-card .inner {
        width: 16.15rem;
        background: #fff8f2;
        border-radius: .5rem;
    }

    /*暂无好友瓜分*/
    .coupon-blank .inner {
        height: 7rem;
        text-align: center;
    }

    img.coupon-blank {
        width: 3.225rem;
        height: 3.15rem;
        margin: 1.2rem auto 0;
    }

    .coupon-blank .inner .text {
        font-size: .65rem;
        color: #9e6d35;
        margin-top: .4rem;
    }

    /*好友瓜分记录*/
    .luck-list .inner {
        padding-top: .5rem;
        padding-bottom: .5rem;
    }

    .luck-list .item {
        display: flex;
        line-height: 2rem;
        font-size: .65rem;
        color: #9e6d35;
        padding: .3rem 1.9rem .3rem 1rem;
    }

    .luck-list .item .adver {
        width: 2rem;
        height: 2rem;
        border-radius: 1rem;
        margin-right: 1rem;
    }

    .luck-list .item .name {
        flex: 1;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
    }

    .luck-list .look {
        width: 7rem;
        height: 1.75rem;
        font-size: .7rem;
        text-align: center;
        line-height: 1.75rem;
        color: #ff4946;
        font-weight: bold;
        margin: .75rem auto 0;
        border-radius: .89rem;
        border: 1px solid #ff4946;
        margin-bottom: .4rem;
    }

    /*活动说明*/
    .explain .inner {
        padding-top: .8rem;
        padding-bottom: .01rem;
    }

    .explain .explain-title {
        width: 4.1rem;
        height: 1.12rem;
        line-height: 1.12rem;
        border-radius: .56rem;
        text-align: center;
        color: #fff;
        font-size: .65rem;
        font-weight: bold;
        margin: 0 auto .75rem;
        background: linear-gradient(to bottom, #ff6f47, #ff4746) !important;
    }

    .explain .explain-con p {
        font-size: .6rem;
        color: #666;
        padding: 0 .7rem;
        line-height: .95rem;
    }

    .explain .explain-con p span {
        color: #ca3a0e;
    }

    .explain-step {
        font-size: .6rem;
        color: #666;
        line-height: .95rem;
        margin-bottom: .6rem;
        padding: 0 .7rem;
    }

    /*领取*/
    .header .get {
        width: 15.25rem;
        margin: 0 auto;
        padding-top: 8.4rem;
        text-align: center;
    }

    .header .get img {
        width: 4.225rem;
        height: 4.175rem;
    }

    .header .get .price {
        font-size: 2.25rem;
        color: #ff3c00;
        height: 4.8rem;
        box-sizing: border-box;
        padding-top: 1.5rem;
    }

    .header .get .price span {
        display: inline-block;
        font-size: .65rem;
        width: 1.05rem;
        height: 1.05rem;
        border-radius: 50%;
        margin-left: .2rem;
        color: #fff;
        text-align: center;
        line-height: 1.05rem;
        position: relative;
        top: -.3rem;
        background: linear-gradient(to bottom, #fb6238, #ff3c00) !important;
    }

    .header .get .txt {
        font-size: .75rem;
        color: #fff3b3;
    }

    /*领取成功*/
    .header .success {
        width: 15.25rem;
        margin: 0 auto;
        padding-top: 8.4rem;
        text-align: center;
    }

    .header .success .text {
        font-size: .75rem;
        font-weight: bold;
        color: #ff4746;
        padding-top: 1.7rem;
    }

    .header .success .text .price {
        font-size: 1.5rem;
        color: #ff3c00;
    }

    .header .success .text .price span {
        font-size: .65rem;
        color: #ff3c00;
    }

    .header .success .text .txt {
        font-size: .65rem;
        color: #9e6d35;
    }

    .header .success .btns {
        display: flex;
        margin-top: 1.75rem;
    }

    .header .success .btns .btn,
    .header .share .btns .btn {
        width: 6.5rem;
        height: 2rem;
        line-height: 2rem;
        border-radius: 1rem;
        border: none;
        color: #fff;
        font-size: .7rem;
        font-weight: bold;
        text-align: center;
        background: linear-gradient(to bottom, #ffd235, #fd842c) !important;
    }

    /*领取成功*/
    .header .share {
        width: 15.25rem;
        margin: 0 auto;
        padding-top: 8.4rem;
        text-align: center;
    }

    .header .share .text {
        padding-top: 2rem;
    }

    .header .share .text .name {
        font-size: .75rem;
        color: #ff4746;
        font-weight: bold;
    }

    .header .share .text .price {
        font-size: .75rem;
        color: #9e6035;
        margin-top: .4rem;
    }

    .header .share .text .price span,
    .header .share .text .txt span {
        color: #ff3c00;
    }

    .header .share .text .txt {
        font-size: .65rem;
        color: #9e6035;
        margin-top: .4rem;
    }

    .header .share .btns {
        display: flex;
        margin-top: 1.65rem;
    }
    #cover {
        display: none;
        position: fixed;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        z-index: 18888;
        background-color: #000000;
        opacity: 0.7;
    }

    #guide {
        display: none;
        position: fixed;
        right: 18px;
        top: 5px;
        z-index: 19999;
    }

    #guide img {
        width: 260px;
        height: 180px;
    }
    .employ{
        display: inline-block;
        position: absolute;
        z-index: 6;
        width: 4.85rem;
        height: 4.85rem;
        right: 1.9rem;
        top: 8rem;
    }

    /*提示弹窗*/
    .coupon-model{
        background: rgba(0,0,0,.5);
        position: fixed;
        top: 0;
        left:0;
        bottom:0;
        right: 0;
        z-index: 9;
    }
    .coupon-model .inner{
        width: 15.75rem;
        height: 8.5rem;
        border-radius: .4rem;
        background: #fff;
        margin: 8rem auto 0;
        position: relative;
    }

    .coupon-model .inner .title{
        font-size: .85rem;
        color: #333;
        font-weight: bold;
        line-height: 1;
        padding-top: 1.3rem;
        text-align: center;
    }
    .coupon-model .inner .content{
        height: 4.1rem;
        font-size: .7rem;
        color: #666;
        text-align: center;
        padding: 0 3rem;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    .coupon-model .inner .btns{
        display: flex;
        position: relative;
    }
    .coupon-model .inner .btns:before{
        content: "";
        position: absolute;
        border-top: 1px solid #ededed;
        top:0;
        left: 0;
        right: 0;
    }
    .coupon-model .inner .btns .btn1{
        flex: 1;
        text-align: center;
        line-height: 2.25rem;
        color: #333;
        font-size: .75rem;
        height: 2.25rem;
        position: relative;
    }
    .coupon-model .inner .btns .btn1.line:after{
        content: "";
        position: absolute;
        border-right: 1px solid #ededed;
        top:0;
        right: 0;
        bottom: 0;
    }
</style>
<div class='fui-page  fui-page-current' style="overflow: scroll;">
<div id="cover"></div>
<div id="guide"><img src="../addons/ewei_shopv2/plugin/groups/template/mobile/default/images/guide1.png"></div>
    <div class="coupon-carve">

        <div class="coupon-model" id="tips" style="display:{if $tips}block{else}none{/if}">
            <div class="inner">
                <div class="title">提醒</div>
                <div class="content" id="tips_content">{$tips}</div>
                <div class="btns">
                    {if $mylink}
                        <a class="btn1 line" href="{$mylink}">查看我的</a>
                    {/if}
                    <a class="btn1" href="{$back}">返回商城</a>
                </div>

            </div>
        </div>



        <div class="header">
            {if !$isReceive && !$isShare}
            <!--领取瓜分券-->
            <div class="get">
                <div class="price">{$activitySetting['coupon_money']}<span>元</span></div>
                <img id="receiveActivity" src="../addons/ewei_shopv2/static/images/coupon-get.png">
                <div class="txt">赶快邀请{$numberOfInvitations}个好友共同瓜分红包吧！</div>
            </div>
            {elseif $isReceive && !$success}
            <!--瓜分中-->
            <div class="underway share">
                <div class="text">
                    <p class="price" style="margin-top: 0">还差<span>{$overPeople}</span>人完成</p>
                    <p class="price">邀请好友一起瓜分<span>{$activitySetting['coupon_money']}</span>元</p>
                    <p class="txt">
                        <span class="countDown">
                            <span class="day">-</span>天
                            <span class="hour">-</span>时
                            <span class="minutes">-</span>分
                            <span class="seconds">-</span>秒
                        </span>
                        后结束
                    </p>
                </div>
                <div class="btns">
                    <a class="btn" href="{$back}">返回商城</a>
                    <div class="btn invitation">邀请好友瓜分</div>
                </div>
            </div>
            {elseif !$success && $isShare && !$isReceive}
            <!--被分享人领取-->
            <div class="share">
                <div class="text">
                    <p class="name">“{$share_user['nickname']}”</p>
                    <p class="price">邀请你一起瓜分<span>{$activitySetting['coupon_money']}</span>元</p>
                    <p class="txt">
                        <span class="countDown">
                            <span class="day">-</span>天
                            <span class="hour">-</span>时
                            <span class="minutes">-</span>分
                            <span class="seconds">-</span>秒
                        </span>
                        后结束
                    </p>
                </div>
                <div class="btns" style="margin-top: 2.65rem">
                    <a class="btn" href="{$back}">返回商城</a>
                    <div class="btn" id="divide">立即瓜分</div>
                </div>
            </div>
            {elseif $isReceive && $success}
            <!--领取成功-->
            {if $coupon && $coupon['used']}<img class="employ" src="../addons/ewei_shopv2/static/images/employ.png" />{/if}
            <div class="success">
                <div class="text">

                    <p>恭喜您获得</p>
                    <p class="price">{$currentActivityInfo['deduct']}<span>元</span></p>
                    {if $currentActivityInfo['enough'] == 0}
                    <p class="txt">无门槛使用券</p>
                    {else}
                    <p class="txt">满{$currentActivityInfo['enough']}元减{$currentActivityInfo['deduct']}元优惠券</p>
                    {/if}

                </div>
                <div class="btns">
                    <a class="btn" href="{$back}">返回商城</a>
                    <a class="btn" id="use_coupon" {if !$coupon['used']}href="{php echo mobileUrl('sale.coupon.my.showcoupongoods', array('id'=>$coupon['id'],'mid'=>$coupon['couponid']),true)}"{else}onclick="FoxUI.toast.show('优惠券已经使用过了哦');return;"{/if}>立即使用</a>
                </div>
            </div>
            {/if}
        </div>
            <div class="carve-title">
                <img src="../addons/ewei_shopv2/static/images/coupon-tip.png">
                <span>好友手气</span>
                <img src="../addons/ewei_shopv2/static/images/coupon-tip.png">
            </div>

            <!--好友手气start-->
            {if $activityData}
            <div class="content-card luck-list">
                <div class="inner" id="content">
                    {loop $activityData $item}
                        <div class="item">
                            <img class="adver" src="{$item['avatar']}">
                            <span class="name" >{$item['nickname']}</span>
                            {if $user['id'] == $activityData[0]['headerid']}
                            <span id="header" data-id="{$user['id']}" style="display: none;"></span>
                            {/if}
                            <span>￥{$item['deduct']}</span>
                        </div>
                    {/loop}
                    {if $activityDataLen > 5}
                    <div class="look" id="more">查看更多</div>
                    {/if}
                </div>
            </div>
            <!--好友手气end-->
            {else}
            <!--暂无好友瓜分start-->
            <div class="content-card coupon-blank">
                <div class="inner">
                    <img class="coupon-blank" src="../addons/ewei_shopv2/static/images/coupon-blank.png">
                    <div class="text">暂时没有好友瓜分哦</div>
                </div>
            </div>
            <!--暂无好友瓜分end-->
            {/if}

        <div class="carve-title">
            <img src="../addons/ewei_shopv2/static/images/coupon-tip.png">
            <span>活动说明</span>
            <img src="../addons/ewei_shopv2/static/images/coupon-tip.png">
        </div>

        <!--活动说明start-->
        <div class="content-card explain">
            <div class="inner">
                <div class="explain-title">活动规则</div>
                <div class="explain-con">
                    <!--<p><span>活动时间：</span>2018-11-25 12:00 至 2019-11-25 12:00</p>-->
                    <p><span>活动时间：</span>{php echo date("Y-m-d H:i:s", $activitySetting['activity_start_time'])} 至 {php echo date("Y-m-d H:i:s", $activitySetting['activity_end_time'])}</p>
                    <p><span>活动时长：</span>{$activitySetting['duration']}小时</p>
                    <p><span>瓜分人数：</span>{$activitySetting['people_count']}人</p>
                </div>

                <div class="explain-title">瓜分步骤</div>
                <div class="explain-step">
                    {loop $activitySetting['desc'] $item}
                    <p>{$item}</p>
                    {/loop}
                </div>
            </div>
        </div>
        <!--活动说明end-->
        <input type="hidden" id="mid" value="{$_GPC['mid']}">

    </div>
</div>
<script>
    require(['../addons/ewei_shopv2/plugin/friendcoupon/static/js/index.js'], function (modal) {
        modal.init({id: {$_GPC['id']}});
    })
</script>
{template '_footer'}